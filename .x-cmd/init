# shellcheck shell=bash disable=SC1091,SC2034 #xsh

# Section: Arg
xrc ui
WORK_DIR="$(x wsroot)"
# EndSection

# Section: Main
if [ ! -d "$WORK_DIR/node_modules" ]; then
    yarn install && lerna bootstrap
else
	case "${1:=repo}" in
		all)
			rm -rf "$WORK_DIR/node_modules" "$WORK_DIR/yarn.lock"
			yarn install && lerna bootstrap
		;;
		none)
			:
		;;
		repo|*)
			ui prompt "$(ui bold green 'Is need to remove node_modules (Y/n)')" _IS_NEED
				if [ -z "$_IS_NEED" ] || [ "$_IS_NEED" = 'y' ] || [ "$_IS_NEED" = 'Y' ] ;then
				rm -rf "$WORK_DIR/node_modules"
				yarn install && lerna bootstrap
				else
				yarn install && lerna bootstrap
				fi
		;;
	esac
fi
# EndSection

